(function(c){var b='<img class="{class_name}" src="{url}" />';var a=c.fn.chosen;c.fn.extend({chosen:function(e){e=e||{};var f=e.html_template||b;this.each(function(g){$this=c(this);$this.on("chosen:ready",function h(q,o){o=o.chosen;var s=o.form_field;var v=s.options;var r=c(o.container).find(".chosen-choices span");if(v&&v.length){for(var m=0;m<v.length;m++){var n=v[m];var l=c(n).attr("selected");var p=c(n).attr("data-img-src");var u=c(n).text();if(l&&p){var t=f.replace("{url}",p);if(r.length){for(var k=0;k<r.length;k++){if(u==c(r[k]).text()){c(r[k]).prepend(t.replace("{class_name}","chose-image"))}}}else{c(o.container).find(".chosen-single span").prepend(t.replace("{class_name}","chose-image-small"))}}}}})});var d=a.apply(this,arguments);this.each(function(h){var i,g;i=c(this);g=i.data("chosen");i.on("change",function k(l,r){var n=g.form_field.options;if(r!=undefined&&r.selected!=undefined&&n&&n.length){for(var o=0;o<n.length;o++){var q=n[o];var s=(c(q).attr("value"))?c(q).attr("value"):c(q).text();var m=c(q).attr("data-img-src");if(m!=undefined&&r.selected==s){var p=f.replace("{url}",m);span=c(g.container).find(".chosen-choices span").last();span.find("img").remove();span.prepend(p.replace("{class_name}","chose-image"));span=c(g.container).find(".chosen-single span");span.find("img").remove();span.prepend(p.replace("{class_name}","chose-image-small"))}}}});i.on("chosen:hiding_dropdown",function(q,l){var n=g.form_field.options;var p=c(g.form_field).find(":selected");if(!p){return}var m=p.attr("data-img-src");if(!m){return}var o=f.replace("{url}",m);span=c(g.container).find(".chosen-choices span").last();span.find("img").remove();span.prepend(o.replace("{class_name}","chose-image"));span=c(g.container).find(".chosen-single span");span.find("img").remove();span.prepend(o.replace("{class_name}","chose-image-small"))});i.on("chosen:showing_dropdown",function j(p,r){var s=c(g.container).find(".chosen-drop ul li:not(:has(img))");var t=g.form_field.options;for(var l=0;l<s.length;l++){var q=s[l];var m=t[l];var n=c(m).attr("data-img-src");if(n!=undefined){var o=f.replace("{url}",n);c(q).prepend(o.replace("{class_name}","chose-image-list"))}}})});return d}})})(jQuery);